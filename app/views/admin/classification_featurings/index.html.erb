<% page_title "Featured items on " + @classification.name %>

<% content_for :current_tab do %>
  <p class="warning">Warning: changes to featured content appear instantly on the live site.</p>

  <h2>Featured documents</h2>
  <p>A maximum of 5 featured documents will be displayed on the live site.</p>

  <% if @classification_featurings.many? %>

    <p class="alert alert-info">
    To change the order of your featured documents, drag them up or down and then click "Save features order".
    </p>

    <%= form_tag [:order, :admin, @classification, ClassificationFeaturing], method: :put do %>
      <fieldset class="sortable">
        <% @classification.classification_featurings.each do |classification_featuring| %>
          <div class="well">
            <%= label_tag "ordering[#{classification_featuring.id}]", link_to(classification_featuring.edition.title, admin_edition_path(classification_featuring.edition)) %>
            <%= text_field_tag "ordering[#{classification_featuring.id}]", classification_featuring.ordering, class: "ordering js-hidden" %>
          </div>
        <% end %>
      </fieldset>
      <%= submit_tag "Save features order", class: "btn" %>
    <% end %>

  <% elsif @classification_featurings.any? %>

    <% @classification_featurings.each do |cf| %>
      <div class="well">
        <%= link_to(cf.edition.title, admin_edition_path(cf.edition)) %>
      </div>
    <% end %>

  <% else %>
    None
  <% end %>

  <h2>Published documents</h2>
  <br/>

  <div class="row-fluid">
    <div class="span3">
      <%= render partial: 'admin/editions/filter_options', locals: { filter_by: [:title, :type, :author, :organisation], filter_action: admin_topic_classification_featurings_url(@classification) } %>
    </div>
    <div class="span9" id="search_results">
      <%= render partial: 'admin/classification_featurings/featured_documents' %>
    </div>
  </div>
<% end %>

<%= render partial: "admin/classifications/tab_wrapper", locals: { model: @classification } %>
